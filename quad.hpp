template <int NQUAD>
class Quad {
public:
  double ve_wgt[NQUAD][3];
  double p_wgt[NQUAD];
  
  Quad() {
    switch(NQUAD) {
    case 1:
      ve_wgt[0][0] = 1.0/3.0;
      ve_wgt[0][1] = 1.0/3.0;
      ve_wgt[0][2] = 1.0/3.0;
      p_wgt[0] = 1.0;

      break;
    case 3:
      ve_wgt[0][0] = 4.0/6.0;
      ve_wgt[0][1] = 1.0/6.0;
      ve_wgt[0][2] = 1.0/6.0;
      p_wgt[0] = 1.0/3.0;

      ve_wgt[1][1] = 4.0/6.0;
      ve_wgt[1][2] = 1.0/6.0;
      ve_wgt[1][0] = 1.0/6.0;
      p_wgt[1] = 1.0/3.0;
      
      ve_wgt[2][2] = 4.0/6.0;
      ve_wgt[2][0] = 1.0/6.0;
      ve_wgt[2][1] = 1.0/6.0;
      p_wgt[2] = 1.0/3.0;
      
      break;
    case 6:
      ve_wgt[0][0] = 0.659027622374092;
      ve_wgt[0][1] = 0.231933368553031;
      ve_wgt[0][2] = 0.109039009072877;
      p_wgt[0] = 1.0/6.0;

      ve_wgt[1][1] = 0.659027622374092;
      ve_wgt[1][2] = 0.231933368553031;
      ve_wgt[1][0] = 0.109039009072877;
      p_wgt[1] = 1.0/6.0;

      ve_wgt[2][2] = 0.659027622374092;
      ve_wgt[2][0] = 0.231933368553031;
      ve_wgt[2][1] = 0.109039009072877;
      p_wgt[2] = 1.0/6.0;

      ve_wgt[3][0] = 0.659027622374092;
      ve_wgt[3][2] = 0.231933368553031;
      ve_wgt[3][1] = 0.109039009072877;
      p_wgt[3] = 1.0/6.0;

      ve_wgt[4][1] = 0.659027622374092;
      ve_wgt[4][0] = 0.231933368553031;
      ve_wgt[4][2] = 0.109039009072877;
      p_wgt[4] = 1.0/6.0;

      ve_wgt[5][2] = 0.659027622374092;
      ve_wgt[5][1] = 0.231933368553031;
      ve_wgt[5][0] = 0.109039009072877;
      p_wgt[5] = 1.0/6.0;

      break;
    case 12:
      ve_wgt[0][0] = 0.873821971016996;
      ve_wgt[0][1] = 0.063089014491502;
      ve_wgt[0][2] = 0.063089014491502;
      p_wgt[0] = 0.050844906370207;

      ve_wgt[1][1] = 0.873821971016996;
      ve_wgt[1][2] = 0.063089014491502;
      ve_wgt[1][0] = 0.063089014491502;
      p_wgt[1] = 0.050844906370207;

      ve_wgt[2][2] = 0.873821971016996;
      ve_wgt[2][0] = 0.063089014491502;
      ve_wgt[2][1] = 0.063089014491502;
      p_wgt[2] = 0.050844906370207;

      ve_wgt[3][0] = 0.501426509658179;
      ve_wgt[3][1] = 0.249286745170910;
      ve_wgt[3][2] = 0.249286745170910;
      p_wgt[3] = 0.116786275726379;

      ve_wgt[4][1] = 0.501426509658179;
      ve_wgt[4][2] = 0.249286745170910;
      ve_wgt[4][0] = 0.249286745170910;
      p_wgt[4] = 0.116786275726379;

      ve_wgt[5][2] = 0.501426509658179;
      ve_wgt[5][0] = 0.249286745170910;
      ve_wgt[5][1] = 0.249286745170910;
      p_wgt[5] = 0.116786275726379;

      ve_wgt[6][0] = 0.636502499121399;
      ve_wgt[6][1] = 0.310352451033785;
      ve_wgt[6][2] = 0.053145049844816;
      p_wgt[6] = 0.082851075618374;

      ve_wgt[7][1] = 0.636502499121399;
      ve_wgt[7][2] = 0.310352451033785;
      ve_wgt[7][0] = 0.053145049844816;
      p_wgt[7] = 0.082851075618374;

      ve_wgt[8][2] = 0.636502499121399;
      ve_wgt[8][0] = 0.310352451033785;
      ve_wgt[8][1] = 0.053145049844816;
      p_wgt[8] = 0.082851075618374;

      ve_wgt[9][0] = 0.636502499121399;
      ve_wgt[9][2] = 0.310352451033785;
      ve_wgt[9][1] = 0.053145049844816;
      p_wgt[9] = 0.082851075618374;
      
      ve_wgt[10][1] = 0.636502499121399;
      ve_wgt[10][0] = 0.310352451033785;
      ve_wgt[10][2] = 0.053145049844816;
      p_wgt[10] = 0.082851075618374;

      ve_wgt[11][2] = 0.636502499121399;
      ve_wgt[11][1] = 0.310352451033785;
      ve_wgt[11][0] = 0.053145049844816;
      p_wgt[11] = 0.082851075618374;
      
      break;
    case 37:
      ve_wgt[0][0] = 0.333333333333333333333333333333;  
      ve_wgt[0][1] = 0.333333333333333333333333333333;
      ve_wgt[0][2] = 1.0 - ve_wgt[0][0] - ve_wgt[0][1];
      
      ve_wgt[1][0] = 0.950275662924105565450352089520;
      ve_wgt[1][1] = 0.024862168537947217274823955239;
      ve_wgt[1][2] = 1.0 - ve_wgt[1][0] - ve_wgt[1][1];
      
      ve_wgt[2][0] = 0.024862168537947217274823955239;
      ve_wgt[2][1] = 0.950275662924105565450352089520;
      ve_wgt[2][2] = 1.0 - ve_wgt[2][0] - ve_wgt[2][1];
      
      ve_wgt[3][0] = 0.024862168537947217274823955239;
      ve_wgt[3][1] = 0.024862168537947217274823955239;
      ve_wgt[3][2] = 1.0 - ve_wgt[3][0] - ve_wgt[3][1];
      
      ve_wgt[4][0] = 0.171614914923835347556304795551;
      ve_wgt[4][1] = 0.414192542538082326221847602214;
      ve_wgt[4][2] = 1.0 - ve_wgt[4][0] - ve_wgt[4][1];
      
      ve_wgt[5][0] = 0.414192542538082326221847602214;
      ve_wgt[5][1] = 0.171614914923835347556304795551;
      ve_wgt[5][2] = 1.0 - ve_wgt[5][0] - ve_wgt[5][1];
      
      ve_wgt[6][0] = 0.414192542538082326221847602214;
      ve_wgt[6][1] = 0.414192542538082326221847602214;
      ve_wgt[6][2] = 1.0 - ve_wgt[6][0] - ve_wgt[6][1];  
      
      ve_wgt[7][0] = 0.539412243677190440263092985511; 
      ve_wgt[7][1] = 0.230293878161404779868453507244;
      ve_wgt[7][2] = 1.0 - ve_wgt[7][0] - ve_wgt[7][1];
      
      ve_wgt[8][0] = 0.230293878161404779868453507244;
      ve_wgt[8][1] = 0.539412243677190440263092985511;
      ve_wgt[8][2] = 1.0 - ve_wgt[8][0] - ve_wgt[8][1];
      
      ve_wgt[9][0] = 0.230293878161404779868453507244;
      ve_wgt[9][1] = 0.230293878161404779868453507244;
      ve_wgt[9][2] = 1.0 - ve_wgt[9][0] - ve_wgt[9][1];
      
      ve_wgt[10][0] = 0.772160036676532561750285570113;
      ve_wgt[10][1] = 0.113919981661733719124857214943;
      ve_wgt[10][2] = 1.0 - ve_wgt[10][0] - ve_wgt[10][1];
      
      ve_wgt[11][0] = 0.113919981661733719124857214943;
      ve_wgt[11][1] = 0.772160036676532561750285570113;
      ve_wgt[11][2] = 1.0 - ve_wgt[11][0] - ve_wgt[11][1];
      
      ve_wgt[12][0] = 0.113919981661733719124857214943;
      ve_wgt[12][1] = 0.113919981661733719124857214943;
      ve_wgt[12][2] = 1.0 - ve_wgt[12][0] - ve_wgt[12][1];
      
      ve_wgt[13][0] = 0.009085399949835353883572964740;
      ve_wgt[13][1] = 0.495457300025082323058213517632;
      ve_wgt[13][2] = 1.0 - ve_wgt[13][0] - ve_wgt[13][1];
      
      ve_wgt[14][0] = 0.495457300025082323058213517632;
      ve_wgt[14][1] = 0.009085399949835353883572964740;
      ve_wgt[14][2] = 1.0 - ve_wgt[14][0] - ve_wgt[14][1];
      
      ve_wgt[15][0] = 0.495457300025082323058213517632;
      ve_wgt[15][1] = 0.495457300025082323058213517632;
      ve_wgt[15][2] = 1.0 - ve_wgt[15][0] - ve_wgt[15][1];
      
      ve_wgt[16][0] = 0.062277290305886993497083640527; 
      ve_wgt[16][1] = 0.468861354847056503251458179727;
      ve_wgt[16][2] = 1.0 - ve_wgt[16][0] - ve_wgt[16][1];
      
      ve_wgt[17][0] = 0.468861354847056503251458179727;  
      ve_wgt[17][1] = 0.062277290305886993497083640527;
      ve_wgt[17][2] = 1.0 - ve_wgt[17][0] - ve_wgt[17][1];
      
      ve_wgt[18][0] = 0.468861354847056503251458179727; 
      ve_wgt[18][1] = 0.468861354847056503251458179727;
      ve_wgt[18][2] = 1.0 - ve_wgt[18][0] - ve_wgt[18][1];
      
      ve_wgt[19][0] = 0.022076289653624405142446876931;
      ve_wgt[19][1] = 0.851306504174348550389457672223;
      ve_wgt[19][2] = 1.0 - ve_wgt[19][0] - ve_wgt[19][1];
      
      ve_wgt[20][0] = 0.022076289653624405142446876931;
      ve_wgt[20][1] = 0.126617206172027096933163647918;
      ve_wgt[20][2] = 1.0 - ve_wgt[20][0] - ve_wgt[20][1];
      
      ve_wgt[21][0] = 0.851306504174348550389457672223;
      ve_wgt[21][1] = 0.022076289653624405142446876931;
      ve_wgt[21][2] = 1.0 - ve_wgt[21][0] - ve_wgt[21][1];
      
      ve_wgt[22][0] = 0.851306504174348550389457672223;
      ve_wgt[22][1] = 0.126617206172027096933163647918;
      ve_wgt[22][2] = 1.0 - ve_wgt[22][0] - ve_wgt[22][1];
      
      ve_wgt[23][0] = 0.126617206172027096933163647918;
      ve_wgt[23][1] = 0.022076289653624405142446876931;
      ve_wgt[23][2] = 1.0 - ve_wgt[23][0] - ve_wgt[23][1];
      
      ve_wgt[24][0] = 0.126617206172027096933163647918;
      ve_wgt[24][1] = 0.851306504174348550389457672223;
      ve_wgt[24][2] = 1.0 - ve_wgt[24][0] - ve_wgt[24][1];
      
      ve_wgt[25][0] = 0.018620522802520968955913511549;
      ve_wgt[25][1] = 0.689441970728591295496647976487;
      ve_wgt[25][2] = 1.0 - ve_wgt[25][0] - ve_wgt[25][1];
      
      ve_wgt[26][0] = 0.018620522802520968955913511549;
      ve_wgt[26][1] = 0.291937506468887771754472382212;
      ve_wgt[26][2] = 1.0 - ve_wgt[26][0] - ve_wgt[26][1];
      
      ve_wgt[27][0] = 0.689441970728591295496647976487;
      ve_wgt[27][1] = 0.018620522802520968955913511549;
      ve_wgt[27][2] = 1.0 - ve_wgt[27][0] - ve_wgt[27][1];
      
      ve_wgt[28][0] = 0.689441970728591295496647976487;
      ve_wgt[28][1] = 0.291937506468887771754472382212;
      ve_wgt[28][2] = 1.0 - ve_wgt[28][0] - ve_wgt[28][1];
      
      ve_wgt[29][0] = 0.291937506468887771754472382212;
      ve_wgt[29][1] = 0.018620522802520968955913511549;
      ve_wgt[29][2] = 1.0 - ve_wgt[29][0] - ve_wgt[29][1];
      
      ve_wgt[30][0] = 0.291937506468887771754472382212;
      ve_wgt[30][1] = 0.689441970728591295496647976487;
      ve_wgt[30][2] = 1.0 - ve_wgt[30][0] - ve_wgt[30][1];
      
      ve_wgt[31][0] = 0.096506481292159228736516560903;
      ve_wgt[31][1] = 0.635867859433872768286976979827;
      ve_wgt[31][2] = 1.0 - ve_wgt[31][0] - ve_wgt[31][1];
      
      ve_wgt[32][0] = 0.096506481292159228736516560903;
      ve_wgt[32][1] = 0.267625659273967961282458816185;
      ve_wgt[32][2] = 1.0 - ve_wgt[32][0] - ve_wgt[32][1];
      
      ve_wgt[33][0] = 0.635867859433872768286976979827;
      ve_wgt[33][1] = 0.096506481292159228736516560903;
      ve_wgt[33][2] = 1.0 - ve_wgt[33][0] - ve_wgt[33][1];

      ve_wgt[34][0] = 0.635867859433872768286976979827;
      ve_wgt[34][1] = 0.267625659273967961282458816185;
      ve_wgt[34][2] = 1.0 - ve_wgt[34][0] - ve_wgt[34][1];
      
      ve_wgt[35][0] = 0.267625659273967961282458816185;
      ve_wgt[35][1] = 0.096506481292159228736516560903;
      ve_wgt[35][2] = 1.0 - ve_wgt[35][0] - ve_wgt[35][1];
      
      ve_wgt[36][0] = 0.267625659273967961282458816185;
      ve_wgt[36][1] = 0.635867859433872768286976979827;
      ve_wgt[36][2] = 1.0 - ve_wgt[36][0] - ve_wgt[36][1];
      
      p_wgt[0] = 0.051739766065744133555179145422;
      p_wgt[1] = 0.008007799555564801597804123460;
      p_wgt[2] = 0.008007799555564801597804123460;
      p_wgt[3] = 0.008007799555564801597804123460;
      p_wgt[4] = 0.046868898981821644823226732071;
      p_wgt[5] = 0.046868898981821644823226732071;
      p_wgt[6] = 0.046868898981821644823226732071;
      p_wgt[7] = 0.046590940183976487960361770070;
      p_wgt[8] = 0.046590940183976487960361770070;
      p_wgt[9] = 0.046590940183976487960361770070;
      p_wgt[10] = 0.031016943313796381407646220131;
      p_wgt[11] = 0.031016943313796381407646220131;
      p_wgt[12] = 0.031016943313796381407646220131;
      p_wgt[13] = 0.010791612736631273623178240136;
      p_wgt[14] = 0.010791612736631273623178240136;
      p_wgt[15] = 0.010791612736631273623178240136;
      p_wgt[16] = 0.032195534242431618819414482205;
      p_wgt[17] = 0.032195534242431618819414482205;
      p_wgt[18] = 0.032195534242431618819414482205;
      p_wgt[19] = 0.015445834210701583817692900053;
      p_wgt[20] = 0.015445834210701583817692900053;
      p_wgt[21] = 0.015445834210701583817692900053;
      p_wgt[22] = 0.015445834210701583817692900053;
      p_wgt[23] = 0.015445834210701583817692900053;
      p_wgt[24] = 0.015445834210701583817692900053;
      p_wgt[25] = 0.017822989923178661888748319485;
      p_wgt[26] = 0.017822989923178661888748319485;
      p_wgt[27] = 0.017822989923178661888748319485;
      p_wgt[28] = 0.017822989923178661888748319485;
      p_wgt[29] = 0.017822989923178661888748319485;
      p_wgt[30] = 0.017822989923178661888748319485;
      p_wgt[31] = 0.037038683681384627918546472190;
      p_wgt[32] = 0.037038683681384627918546472190;
      p_wgt[33] = 0.037038683681384627918546472190;
      p_wgt[34] = 0.037038683681384627918546472190;
      p_wgt[35] = 0.037038683681384627918546472190;
      p_wgt[36] = 0.037038683681384627918546472190;

      break;
    default:
      assert(0);
    }
   

    double p_sum = 0;
    for (int iq = 0; iq < NQUAD; ++iq) {
      p_sum += p_wgt[iq];
      double ve_sum = 0;
      for (int i = 0; i < 3; ++i) ve_sum += ve_wgt[iq][i];
      assert(fabs(ve_sum - 1.0) < 1e-12);      
    }
    assert(fabs(p_sum - 1.0) < 1e-12);      
          
  }

};
